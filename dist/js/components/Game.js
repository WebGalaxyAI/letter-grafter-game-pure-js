import GameTimer from"./GameTimer.js";import HintBox from"./HintBox.js";import Modal from"./Modal.js";import GuessedWords from"./GuessedWords.js";class Game{constructor(t,e){this.words=t,this.remainingWords=[...t],this.colors=e,this.gameTimer=new GameTimer,this.hintBox=new HintBox(this.gameTimer),this.modal=new Modal(this.gameTimer),this.guessedWords=new GuessedWords(this.words.length),this.lettersContainer=document.querySelector(".letters"),this.resetGame=document.querySelector("#reset-game"),this.audioGameStart=new Audio("audio/game-start.mp3"),this.audioClick=new Audio("audio/click.mp3"),this.selectedWord="",this.selectedWordHint="",this.hintButton=document.getElementById("show-hint")}start(){setTimeout((()=>{this.audioGameStart.play(),this.gameTimer.start(),this.playNextWord(),this.addListeners()}),500)}spliceRandomWord(){const t=Math.floor(Math.random()*this.remainingWords.length);return this.remainingWords.splice(t,1)[0]}drawLetters(t,e){t.forEach((t=>{const s=document.createElement("div");s.classList.add("letters__item"),s.textContent=t,s.style.color=e[Math.floor(Math.random()*e.length)],this.lettersContainer.appendChild(s)}))}shuffleArray(t){let e,s=[...t],i=t.length;for(;i>0;)e=Math.floor(Math.random()*i),i--,[t[i],t[e]]=[t[e],t[i]];return JSON.stringify(t)===JSON.stringify(s)?this.shuffleArray([...t]):t}addListeners(){this.hintButton.addEventListener("click",(t=>{this.hintBox.showHint(this.selectedWordHint)})),this.lettersContainer.addEventListener("click",(t=>{this.audioClick.play();const e=t.target;if(e.classList.contains("letters__item")){const t=this.lettersContainer.querySelectorAll(".letters__item");Array.from(t).indexOf(e)>0&&e.previousElementSibling.before(e),this.lettersContainer.textContent.trim()===this.selectedWord&&this.wordGuessed(),this.resetGame.addEventListener("click",(()=>{this.startOver()}))}})),window.addEventListener("guessedModalClosed",(()=>{this.playNextWord()})),window.addEventListener("finishedModalClosed",(()=>{this.startOver()}))}wordGuessed(){this.modal.showModal(`Congratulations! You guessed the word: ${this.selectedWord}`),this.guessedWords.increaseGuessedWordsCount()}playNextWord(){if(this.lettersContainer.innerHTML="",this.remainingWords.length>0){const t=this.spliceRandomWord();this.selectedWord=t.word.toUpperCase(),this.selectedWordHint=t.hint;const e=this.shuffleArray(this.selectedWord.split(""));this.drawLetters(e,this.colors)}else setTimeout((()=>{this.modal.showModal("Ви вгадали всі слова! Гра завершена","finishedModal")}),500)}startOver(){this.audioGameStart.play(),this.lettersContainer.innerHTML="",this.guessedWords.resetCounter(),this.gameTimer.reset(),this.remainingWords=[...this.words],this.playNextWord()}}export default Game;