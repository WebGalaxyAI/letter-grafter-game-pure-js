import GameTimer from"./GameTimer.js";import HintBox from"./HintBox.js";import Modal from"./Modal.js";import GuessedWords from"./GuessedWords.js";class Game{constructor(e,t){this.words=e,this.remainingWords=[...e],this.colors=t,this.gameTimer=new GameTimer,this.hintBox=new HintBox(this.gameTimer),this.modal=new Modal(this.gameTimer),this.guessedWords=new GuessedWords(this.words.length),this.lettersContainer=document.querySelector(".letters"),this.resetGame=document.querySelector("#reset-game"),this.audioGameStart=new Audio("audio/game-start.mp3"),this.audioClick=new Audio("audio/click.mp3"),this.selectedWord="",this.selectedWordHint="",this.hintButton=document.getElementById("show-hint")}start(){setTimeout((()=>{this.gameTimer.start(),this.playNextWord(),this.addListeners()}),500)}spliceRandomWord(){const e=Math.floor(Math.random()*this.remainingWords.length);return this.remainingWords.splice(e,1)[0]}drawLetters(e,t){e.forEach((e=>{const s=document.createElement("div");s.classList.add("letters__item"),s.textContent=e,s.style.color=t[Math.floor(Math.random()*t.length)],this.lettersContainer.appendChild(s)}))}shuffleArray(e){let t,s=[...e],i=e.length;for(;i>0;)t=Math.floor(Math.random()*i),i--,[e[i],e[t]]=[e[t],e[i]];return JSON.stringify(e)===JSON.stringify(s)?this.shuffleArray([...e]):e}addListeners(){this.hintButton.addEventListener("click",(e=>{this.hintBox.showHint(this.selectedWordHint)})),this.lettersContainer.addEventListener("click",(e=>{this.audioClick.play();const t=e.target;if(t.classList.contains("letters__item")){const e=this.lettersContainer.querySelectorAll(".letters__item");Array.from(e).indexOf(t)>0&&t.previousElementSibling.before(t),this.lettersContainer.textContent.trim()===this.selectedWord&&this.wordGuessed()}})),this.resetGame.addEventListener("click",(()=>{this.startOver()})),window.addEventListener("guessedModalClosed",(()=>{this.playNextWord()})),window.addEventListener("finishedModalClosed",(()=>{this.startOver()}))}wordGuessed(){this.modal.showModal(`Congratulations! You guessed the word: ${this.selectedWord}`),this.guessedWords.increaseGuessedWordsCount()}playNextWord(){if(this.lettersContainer.innerHTML="",this.remainingWords.length>0){const e=this.spliceRandomWord();this.selectedWord=e.word.toUpperCase(),this.selectedWordHint=e.hint;const t=this.shuffleArray(this.selectedWord.split(""));this.drawLetters(t,this.colors)}else setTimeout((()=>{this.modal.showModal("You guessed all the words! Game over","finishedModal")}),500)}startOver(){this.audioGameStart.play(),this.lettersContainer.innerHTML="",this.guessedWords.resetCounter(),this.gameTimer.reset(),this.remainingWords=[...this.words],this.playNextWord()}}export default Game;